<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="Завдання"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <style>
        body {
            background: linear-gradient(to bottom right, white, lightgreen, lightskyblue) fixed;
        }
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
</head>
<body>
<div class="d-flex flex-column flex-shrink-0 p-3 text-bg-dark" style="width: 280px;">
    <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
        <svg class="bi pe-none me-2" width="40" height="32"><use xlink:href="#bootstrap"></use></svg>
        <span class="fs-4">Task Schedule</span>
    </a>
    <hr>
    <ul class="nav nav-pills flex-column mb-auto">
        <li class="nav-item">
            <a href="/" class="nav-link text-white" aria-current="page">
                <svg class="bi pe-none me-2" width="16" height="16"><use xlink:href="#home"></use></svg>
                Home
            </a>
        </li>
        <li>
            <a href="/task" class="nav-link text-white">
                <svg class="bi pe-none me-2" width="16" height="16"><use xlink:href="#speedometer2"></use></svg>
                Tasks
            </a>
        </li>
    </ul>
    <hr>
    <div class="dropdown">
        <a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
            <strong>FryMondo</strong>
        </a>
        <ul class="dropdown-menu dropdown-menu-dark text-small shadow">
            <li><a class="dropdown-item" href="#">Sign out</a></li>
        </ul>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<div class="container mt-5">
    <h1>Завдання</h1>
</div>

<!-- Код для додавання завдання -->
<div class="container mt-3">
    <form>
        <div class="mb-3">
            <label for="taskTitle" class="form-label">Заголовок завдання</label>
            <input type="text" class="form-control" id="taskTitle" placeholder="Введіть заголовок завдання">
        </div>
        <div class="mb-3">
            <label for="taskDescription" class="form-label">Текст завдання</label>
            <textarea class="form-control" id="taskDescription" rows="3" placeholder="Введіть текст завдання"></textarea>
        </div>
        <div class="mb-3">
            <label for="taskDeadline" class="form-label">Термін виконання</label>
            <input type="date" class="form-control" id="taskDeadline">
        </div>
        <button type="button" class="btn btn-primary" onclick="addTask()">Додати завдання</button>
    </form>
</div>

<!-- Код для відображення завдань -->
<div class="container mt-5" id="taskList">
    <!-- Завдання будуть додаватись сюди через JavaScript -->
</div>

<script>
    // Завантаження завдань з localStorage
    var tasks = JSON.parse(localStorage.getItem("tasks")) || [];

    // Функція для збереження завдань у localStorage
    function saveTasks() {
        localStorage.setItem("tasks", JSON.stringify(tasks));
    }

    // Функція для додавання завдання
    function addTask() {
        // Отримуємо значення полів форми
        var taskTitle = document.getElementById("taskTitle").value;
        var taskDescription = document.getElementById("taskDescription").value;
        var taskDeadline = document.getElementById("taskDeadline").value;

        // Створюємо об'єкт з введеними даними
        var task = {
            title: taskTitle,
            description: taskDescription,
            deadline: taskDeadline
        };

        // Додаємо завдання до масиву
        tasks.push(task);

        // Оновлюємо відображення завдань
        displayTasks();

        // Зберігаємо завдання у localStorage
        saveTasks();

        // Очищаємо поля форми
        document.getElementById("taskTitle").value = "";
        document.getElementById("taskDescription").value = "";
        document.getElementById("taskDeadline").value = "";
    }

    // Функція для відображення завдань
    function displayTasks() {
        var taskList = document.getElementById("taskList");
        taskList.innerHTML = "";

        // Проходимося по всіх завданнях у масиві
        for (var i = 0; i < tasks.length; i++) {
            var task = tasks[i];

            // Створюємо HTML-код для кожного завдання
            var taskCard = `
                <div class="card mb-3">
                    <div class="card-body">
                        <h5 class="card-title">${task.title}</h5>
                        <p class="card-text">${task.description}</p>
                        <p class="card-text">Термін виконання: ${task.deadline}</p>
                        <button type="button" class="btn btn-primary" onclick="editTask(${i})">Редагувати</button>
                        <button type="button" class="btn btn-danger" onclick="deleteTask(${i})">Видалити</button>
                    </div>
                </div>
            `;

            // Додаємо завдання до списку
            taskList.innerHTML += taskCard;
        }
    }

    // Функція для редагування завдання
    function editTask(index) {
        // Отримуємо завдання за індексом
        var task = tasks[index];

        // Заповнюємо поля форми зі значеннями завдання
        document.getElementById("taskTitle").value = task.title;
        document.getElementById("taskDescription").value = task.description;
        document.getElementById("taskDeadline").value = task.deadline;

        // Видаляємо завдання зі списку
        tasks.splice(index, 1);

        // Оновлюємо відображення завдань
        displayTasks();

        // Зберігаємо завдання у localStorage
        saveTasks();
    }

    // Функція для видалення завдання
    function deleteTask(index) {
        // Видаляємо завдання зі списку
        tasks.splice(index, 1);

        // Оновлюємо відображення завдань
        displayTasks();

        // Зберігаємо завдання у localStorage
        saveTasks();
    }

    // Відображення початкових завдань при завантаженні сторінки
    displayTasks();
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
